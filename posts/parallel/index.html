<!DOCTYPE html>
<html lang="ja">
<head>
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <script type="text/javascript" src="https://latest.cactus.chat/cactus.js"></script>
  <link rel="stylesheet" href="https://latest.cactus.chat/style.css" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> 探索的因子分析の際の平行分析について | Takahiro ONOSHIMA&#39;s website</title>
  <link rel = 'canonical' href = 'https://onoshima.github.io/posts/parallel/'>
  <meta name="description" content="  早稲田大学大学院教育学研究科で心理統計や心理測定について研究している小野島昂洋の個人ページです。">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta property="og:title" content="探索的因子分析の際の平行分析について" />
<meta property="og:description" content="はじめに 因子分析に関連した調べ物の必要があって，その覚書。今回は平行分析について。
探索的因子分析で因子数を決めるための複数の基準が提案されていますが，平行分析（parallel analysis）はその一つで，因子分析の教科書などでも勧められる方法です。アイデアとしては，分析しようとしているデータセットと同じサイズであるランダムなデータセットから計算された固有値と比べて，ランダムなデータセットよりも大きい固有値までを採用しようという考えのようです。こうすることでサンプリングの誤差に対応できるとのことです。初出はHorn (1965)です。
Rでの実験 Rで平行分析を行うにはpsychパッケージのfa.parallelという関数を用いれば良いのですが，ここでは原理を理解するためにパッケージを使わずにやってみます。使うデータはpsych所収のbfiというデータセットです。ビッグファイブの性格特性の質問紙データで，各因子5項目ずつ計25項目の質問紙のデータです。26列目以降は回答者の属性に関するデータが入っています。サンプルサイズは2800です。
library(psych) dat &lt;- bfi[,1:25] head(dat) A1 A2 A3 A4 A5 C1 C2 C3 C4 C5 E1 E2 E3 E4 E5 N1 N2 N3 N4 N5 O1 O2 O3 O4 O5 61617 2 4 3 4 4 2 3 3 4 4 3 3 3 4 4 3 4 2 2 3 3 6 3 4 3 61618 2 4 5 2 5 5 4 4 3 4 1 1 6 4 3 3 3 3 5 5 4 2 4 3 3 61620 5 4 5 4 4 4 5 4 2 5 2 4 4 4 5 4 5 4 2 3 4 2 5 5 2 61621 4 4 6 5 5 4 4 3 5 5 5 3 4 4 4 2 5 2 4 1 3 3 4 3 5 61622 2 3 3 4 5 4 4 5 3 2 2 2 5 4 5 2 3 4 4 3 3 3 4 3 3 61623 6 6 5 6 5 6 6 6 1 3 2 1 6 5 6 3 5 2 2 3 4 3 5 6 1 まずは，元データからスクリープロットを描いてみます（15因子目まで）。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://onoshima.github.io/posts/parallel/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-09-23T10:39:35+09:00" />
<meta property="article:modified_time" content="2020-09-23T10:39:35+09:00" />


  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="探索的因子分析の際の平行分析について"/>
<meta name="twitter:description" content="はじめに 因子分析に関連した調べ物の必要があって，その覚書。今回は平行分析について。
探索的因子分析で因子数を決めるための複数の基準が提案されていますが，平行分析（parallel analysis）はその一つで，因子分析の教科書などでも勧められる方法です。アイデアとしては，分析しようとしているデータセットと同じサイズであるランダムなデータセットから計算された固有値と比べて，ランダムなデータセットよりも大きい固有値までを採用しようという考えのようです。こうすることでサンプリングの誤差に対応できるとのことです。初出はHorn (1965)です。
Rでの実験 Rで平行分析を行うにはpsychパッケージのfa.parallelという関数を用いれば良いのですが，ここでは原理を理解するためにパッケージを使わずにやってみます。使うデータはpsych所収のbfiというデータセットです。ビッグファイブの性格特性の質問紙データで，各因子5項目ずつ計25項目の質問紙のデータです。26列目以降は回答者の属性に関するデータが入っています。サンプルサイズは2800です。
library(psych) dat &lt;- bfi[,1:25] head(dat) A1 A2 A3 A4 A5 C1 C2 C3 C4 C5 E1 E2 E3 E4 E5 N1 N2 N3 N4 N5 O1 O2 O3 O4 O5 61617 2 4 3 4 4 2 3 3 4 4 3 3 3 4 4 3 4 2 2 3 3 6 3 4 3 61618 2 4 5 2 5 5 4 4 3 4 1 1 6 4 3 3 3 3 5 5 4 2 4 3 3 61620 5 4 5 4 4 4 5 4 2 5 2 4 4 4 5 4 5 4 2 3 4 2 5 5 2 61621 4 4 6 5 5 4 4 3 5 5 5 3 4 4 4 2 5 2 4 1 3 3 4 3 5 61622 2 3 3 4 5 4 4 5 3 2 2 2 5 4 5 2 3 4 4 3 3 3 4 3 3 61623 6 6 5 6 5 6 6 6 1 3 2 1 6 5 6 3 5 2 2 3 4 3 5 6 1 まずは，元データからスクリープロットを描いてみます（15因子目まで）。"/>

  
  
    
  
  
  <link rel="stylesheet" href="https://onoshima.github.io/css/styles.94f653e9e151e28067a7c5dbbc4600cbd5a3c721e79faaf971e523c40f3b249b8e4f20bb57810dfffa8d559ca5c140fd56eb4cd9c0853113ad08e66afdb08bdd.css" integrity="sha512-lPZT6eFR4oBnp8XbvEYAy9WjxyHnn6r5ceUjxA87JJuOTyC7V4EN//qNVZylwUD9VutM2cCFMROtCOZq/bCL3Q=="> 

  
  
  
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
<link rel="icon" type="image/png" href="https://onoshima.github.io/images/favicon.ico" />

  
  
</head>

<body class="max-width mx-auto px3 ltr">
  <div class="content index py4">

  <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;" aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/profile">Profile</a></li>
         
        <li><a href="https://researchmap.jp/onoshima">Works(researchmap)</a></li>
         
        <li><a href="/posts/">Blog</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li>
          <a class="icon" href=" https://onoshima.github.io/posts/vss/" aria-label="Previous">
            <i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i>
          </a>
        </li>
        
        
        <li>
          <a class="icon" href="https://onoshima.github.io/posts/factornumber/" aria-label="Next">
            <i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i>
          </a>
        </li>
        
        <li>
          <a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" aria-label="Top of Page">
            <i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i>
          </a>
        </li>
        <li>
          <a class="icon" href="#" aria-label="Share">
            <i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i>
          </a>
        </li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fonoshima.github.io%2fposts%2fparallel%2f" aria-label="Facebook">
      <i class="fab fa-facebook " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2fonoshima.github.io%2fposts%2fparallel%2f&text=%e6%8e%a2%e7%b4%a2%e7%9a%84%e5%9b%a0%e5%ad%90%e5%88%86%e6%9e%90%e3%81%ae%e9%9a%9b%e3%81%ae%e5%b9%b3%e8%a1%8c%e5%88%86%e6%9e%90%e3%81%ab%e3%81%a4%e3%81%84%e3%81%a6" aria-label="Twitter">
      <i class="fab fa-twitter " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fonoshima.github.io%2fposts%2fparallel%2f&title=%e6%8e%a2%e7%b4%a2%e7%9a%84%e5%9b%a0%e5%ad%90%e5%88%86%e6%9e%90%e3%81%ae%e9%9a%9b%e3%81%ae%e5%b9%b3%e8%a1%8c%e5%88%86%e6%9e%90%e3%81%ab%e3%81%a4%e3%81%84%e3%81%a6" aria-label="Linkedin">
      <i class="fab fa-linkedin " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fonoshima.github.io%2fposts%2fparallel%2f&is_video=false&description=%e6%8e%a2%e7%b4%a2%e7%9a%84%e5%9b%a0%e5%ad%90%e5%88%86%e6%9e%90%e3%81%ae%e9%9a%9b%e3%81%ae%e5%b9%b3%e8%a1%8c%e5%88%86%e6%9e%90%e3%81%ab%e3%81%a4%e3%81%84%e3%81%a6" aria-label="Pinterest">
      <i class="fab fa-pinterest " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=%e6%8e%a2%e7%b4%a2%e7%9a%84%e5%9b%a0%e5%ad%90%e5%88%86%e6%9e%90%e3%81%ae%e9%9a%9b%e3%81%ae%e5%b9%b3%e8%a1%8c%e5%88%86%e6%9e%90%e3%81%ab%e3%81%a4%e3%81%84%e3%81%a6&body=Check out this article: https%3a%2f%2fonoshima.github.io%2fposts%2fparallel%2f" aria-label="Email">
      <i class="fas fa-envelope " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2fonoshima.github.io%2fposts%2fparallel%2f&title=%e6%8e%a2%e7%b4%a2%e7%9a%84%e5%9b%a0%e5%ad%90%e5%88%86%e6%9e%90%e3%81%ae%e9%9a%9b%e3%81%ae%e5%b9%b3%e8%a1%8c%e5%88%86%e6%9e%90%e3%81%ab%e3%81%a4%e3%81%84%e3%81%a6" aria-label="Pocket">
      <i class="fab fa-get-pocket " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2fonoshima.github.io%2fposts%2fparallel%2f&title=%e6%8e%a2%e7%b4%a2%e7%9a%84%e5%9b%a0%e5%ad%90%e5%88%86%e6%9e%90%e3%81%ae%e9%9a%9b%e3%81%ae%e5%b9%b3%e8%a1%8c%e5%88%86%e6%9e%90%e3%81%ab%e3%81%a4%e3%81%84%e3%81%a6" aria-label="reddit">
      <i class="fab fa-reddit " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2fonoshima.github.io%2fposts%2fparallel%2f&name=%e6%8e%a2%e7%b4%a2%e7%9a%84%e5%9b%a0%e5%ad%90%e5%88%86%e6%9e%90%e3%81%ae%e9%9a%9b%e3%81%ae%e5%b9%b3%e8%a1%8c%e5%88%86%e6%9e%90%e3%81%ab%e3%81%a4%e3%81%84%e3%81%a6&description=%e3%81%af%e3%81%98%e3%82%81%e3%81%ab%20%e5%9b%a0%e5%ad%90%e5%88%86%e6%9e%90%e3%81%ab%e9%96%a2%e9%80%a3%e3%81%97%e3%81%9f%e8%aa%bf%e3%81%b9%e7%89%a9%e3%81%ae%e5%bf%85%e8%a6%81%e3%81%8c%e3%81%82%e3%81%a3%e3%81%a6%ef%bc%8c%e3%81%9d%e3%81%ae%e8%a6%9a%e6%9b%b8%e3%80%82%e4%bb%8a%e5%9b%9e%e3%81%af%e5%b9%b3%e8%a1%8c%e5%88%86%e6%9e%90%e3%81%ab%e3%81%a4%e3%81%84%e3%81%a6%e3%80%82%0a%e6%8e%a2%e7%b4%a2%e7%9a%84%e5%9b%a0%e5%ad%90%e5%88%86%e6%9e%90%e3%81%a7%e5%9b%a0%e5%ad%90%e6%95%b0%e3%82%92%e6%b1%ba%e3%82%81%e3%82%8b%e3%81%9f%e3%82%81%e3%81%ae%e8%a4%87%e6%95%b0%e3%81%ae%e5%9f%ba%e6%ba%96%e3%81%8c%e6%8f%90%e6%a1%88%e3%81%95%e3%82%8c%e3%81%a6%e3%81%84%e3%81%be%e3%81%99%e3%81%8c%ef%bc%8c%e5%b9%b3%e8%a1%8c%e5%88%86%e6%9e%90%ef%bc%88parallel%20analysis%ef%bc%89%e3%81%af%e3%81%9d%e3%81%ae%e4%b8%80%e3%81%a4%e3%81%a7%ef%bc%8c%e5%9b%a0%e5%ad%90%e5%88%86%e6%9e%90%e3%81%ae%e6%95%99%e7%a7%91%e6%9b%b8%e3%81%aa%e3%81%a9%e3%81%a7%e3%82%82%e5%8b%a7%e3%82%81%e3%82%89%e3%82%8c%e3%82%8b%e6%96%b9%e6%b3%95%e3%81%a7%e3%81%99%e3%80%82%e3%82%a2%e3%82%a4%e3%83%87%e3%82%a2%e3%81%a8%e3%81%97%e3%81%a6%e3%81%af%ef%bc%8c%e5%88%86%e6%9e%90%e3%81%97%e3%82%88%e3%81%86%e3%81%a8%e3%81%97%e3%81%a6%e3%81%84%e3%82%8b%e3%83%87%e3%83%bc%e3%82%bf%e3%82%bb%e3%83%83%e3%83%88%e3%81%a8%e5%90%8c%e3%81%98%e3%82%b5%e3%82%a4%e3%82%ba%e3%81%a7%e3%81%82%e3%82%8b%e3%83%a9%e3%83%b3%e3%83%80%e3%83%a0%e3%81%aa%e3%83%87%e3%83%bc%e3%82%bf%e3%82%bb%e3%83%83%e3%83%88%e3%81%8b%e3%82%89%e8%a8%88%e7%ae%97%e3%81%95%e3%82%8c%e3%81%9f%e5%9b%ba%e6%9c%89%e5%80%a4%e3%81%a8%e6%af%94%e3%81%b9%e3%81%a6%ef%bc%8c%e3%83%a9%e3%83%b3%e3%83%80%e3%83%a0%e3%81%aa%e3%83%87%e3%83%bc%e3%82%bf%e3%82%bb%e3%83%83%e3%83%88%e3%82%88%e3%82%8a%e3%82%82%e5%a4%a7%e3%81%8d%e3%81%84%e5%9b%ba%e6%9c%89%e5%80%a4%e3%81%be%e3%81%a7%e3%82%92%e6%8e%a1%e7%94%a8%e3%81%97%e3%82%88%e3%81%86%e3%81%a8%e3%81%84%e3%81%86%e8%80%83%e3%81%88%e3%81%ae%e3%82%88%e3%81%86%e3%81%a7%e3%81%99%e3%80%82%e3%81%93%e3%81%86%e3%81%99%e3%82%8b%e3%81%93%e3%81%a8%e3%81%a7%e3%82%b5%e3%83%b3%e3%83%97%e3%83%aa%e3%83%b3%e3%82%b0%e3%81%ae%e8%aa%a4%e5%b7%ae%e3%81%ab%e5%af%be%e5%bf%9c%e3%81%a7%e3%81%8d%e3%82%8b%e3%81%a8%e3%81%ae%e3%81%93%e3%81%a8%e3%81%a7%e3%81%99%e3%80%82%e5%88%9d%e5%87%ba%e3%81%afHorn%20%281965%29%e3%81%a7%e3%81%99%e3%80%82%0aR%e3%81%a7%e3%81%ae%e5%ae%9f%e9%a8%93%20R%e3%81%a7%e5%b9%b3%e8%a1%8c%e5%88%86%e6%9e%90%e3%82%92%e8%a1%8c%e3%81%86%e3%81%ab%e3%81%afpsych%e3%83%91%e3%83%83%e3%82%b1%e3%83%bc%e3%82%b8%e3%81%aefa.parallel%e3%81%a8%e3%81%84%e3%81%86%e9%96%a2%e6%95%b0%e3%82%92%e7%94%a8%e3%81%84%e3%82%8c%e3%81%b0%e8%89%af%e3%81%84%e3%81%ae%e3%81%a7%e3%81%99%e3%81%8c%ef%bc%8c%e3%81%93%e3%81%93%e3%81%a7%e3%81%af%e5%8e%9f%e7%90%86%e3%82%92%e7%90%86%e8%a7%a3%e3%81%99%e3%82%8b%e3%81%9f%e3%82%81%e3%81%ab%e3%83%91%e3%83%83%e3%82%b1%e3%83%bc%e3%82%b8%e3%82%92%e4%bd%bf%e3%82%8f%e3%81%9a%e3%81%ab%e3%82%84%e3%81%a3%e3%81%a6%e3%81%bf%e3%81%be%e3%81%99%e3%80%82%e4%bd%bf%e3%81%86%e3%83%87%e3%83%bc%e3%82%bf%e3%81%afpsych%e6%89%80%e5%8f%8e%e3%81%aebfi%e3%81%a8%e3%81%84%e3%81%86%e3%83%87%e3%83%bc%e3%82%bf%e3%82%bb%e3%83%83%e3%83%88%e3%81%a7%e3%81%99%e3%80%82%e3%83%93%e3%83%83%e3%82%b0%e3%83%95%e3%82%a1%e3%82%a4%e3%83%96%e3%81%ae%e6%80%a7%e6%a0%bc%e7%89%b9%e6%80%a7%e3%81%ae%e8%b3%aa%e5%95%8f%e7%b4%99%e3%83%87%e3%83%bc%e3%82%bf%e3%81%a7%ef%bc%8c%e5%90%84%e5%9b%a0%e5%ad%905%e9%a0%85%e7%9b%ae%e3%81%9a%e3%81%a4%e8%a8%8825%e9%a0%85%e7%9b%ae%e3%81%ae%e8%b3%aa%e5%95%8f%e7%b4%99%e3%81%ae%e3%83%87%e3%83%bc%e3%82%bf%e3%81%a7%e3%81%99%e3%80%8226%e5%88%97%e7%9b%ae%e4%bb%a5%e9%99%8d%e3%81%af%e5%9b%9e%e7%ad%94%e8%80%85%e3%81%ae%e5%b1%9e%e6%80%a7%e3%81%ab%e9%96%a2%e3%81%99%e3%82%8b%e3%83%87%e3%83%bc%e3%82%bf%e3%81%8c%e5%85%a5%e3%81%a3%e3%81%a6%e3%81%84%e3%81%be%e3%81%99%e3%80%82%e3%82%b5%e3%83%b3%e3%83%97%e3%83%ab%e3%82%b5%e3%82%a4%e3%82%ba%e3%81%af2800%e3%81%a7%e3%81%99%e3%80%82%0alibrary%28psych%29%20dat%20%26lt%3b-%20bfi%5b%2c1%3a25%5d%20head%28dat%29%20A1%20A2%20A3%20A4%20A5%20C1%20C2%20C3%20C4%20C5%20E1%20E2%20E3%20E4%20E5%20N1%20N2%20N3%20N4%20N5%20O1%20O2%20O3%20O4%20O5%2061617%202%204%203%204%204%202%203%203%204%204%203%203%203%204%204%203%204%202%202%203%203%206%203%204%203%2061618%202%204%205%202%205%205%204%204%203%204%201%201%206%204%203%203%203%203%205%205%204%202%204%203%203%2061620%205%204%205%204%204%204%205%204%202%205%202%204%204%204%205%204%205%204%202%203%204%202%205%205%202%2061621%204%204%206%205%205%204%204%203%205%205%205%203%204%204%204%202%205%202%204%201%203%203%204%203%205%2061622%202%203%203%204%205%204%204%205%203%202%202%202%205%204%205%202%203%204%204%203%203%203%204%203%203%2061623%206%206%205%206%205%206%206%206%201%203%202%201%206%205%206%203%205%202%202%203%204%203%205%206%201%20%e3%81%be%e3%81%9a%e3%81%af%ef%bc%8c%e5%85%83%e3%83%87%e3%83%bc%e3%82%bf%e3%81%8b%e3%82%89%e3%82%b9%e3%82%af%e3%83%aa%e3%83%bc%e3%83%97%e3%83%ad%e3%83%83%e3%83%88%e3%82%92%e6%8f%8f%e3%81%84%e3%81%a6%e3%81%bf%e3%81%be%e3%81%99%ef%bc%8815%e5%9b%a0%e5%ad%90%e7%9b%ae%e3%81%be%e3%81%a7%ef%bc%89%e3%80%82" aria-label="Tumblr">
      <i class="fab fa-tumblr " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fonoshima.github.io%2fposts%2fparallel%2f&t=%e6%8e%a2%e7%b4%a2%e7%9a%84%e5%9b%a0%e5%ad%90%e5%88%86%e6%9e%90%e3%81%ae%e9%9a%9b%e3%81%ae%e5%b9%b3%e8%a1%8c%e5%88%86%e6%9e%90%e3%81%ab%e3%81%a4%e3%81%84%e3%81%a6" aria-label="Hacker News">
      <i class="fab fa-hacker-news " aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>
    
    <div id="toc">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#はじめに">はじめに</a></li>
    <li><a href="#rでの実験">Rでの実験</a></li>
    <li><a href="#psychのfaparallel関数">psychのfa.parallel関数</a></li>
    <li><a href="#対角smcによる方法">対角SMCによる方法</a></li>
  </ul>
</nav>
    </div>
    
  </span>
</div>


  <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
    <header>
      <h1 class="posttitle" itemprop="name headline">
        探索的因子分析の際の平行分析について
      </h1>
      <div class="meta">
        
        <div class="postdate">
          
          <time datetime="2020-09-23 10:39:35 &#43;0900 JST" itemprop="datePublished">2020-09-23</time>
          
        </div>
        
        
        
        <div class="article-category">
            <i class="fas fa-archive"></i>
            
            
            <a class="category-link" href="/categories/stat">stat</a>
            
             ,  
            <a class="category-link" href="/categories/r">R</a>
            
        </div>
        
        
        <div class="article-tag">
            <i class="fas fa-tag"></i>
            
            
            <a class="tag-link" href="/tags/parallel-analysis" rel="tag">parallel analysis</a>
            
             ,  
            <a class="tag-link" href="/tags/factor-analysis" rel="tag">factor analysis</a>
            
        </div>
        
      </div>
    </header>

  
    
    <div class="content" itemprop="articleBody">
      <h2 id="はじめに">はじめに</h2>
<p>因子分析に関連した調べ物の必要があって，その覚書。今回は平行分析について。</p>
<p>探索的因子分析で因子数を決めるための複数の基準が提案されていますが，平行分析（parallel analysis）はその一つで，因子分析の教科書などでも勧められる方法です。アイデアとしては，分析しようとしているデータセットと同じサイズであるランダムなデータセットから計算された固有値と比べて，ランダムなデータセットよりも大きい固有値までを採用しようという考えのようです。こうすることでサンプリングの誤差に対応できるとのことです。初出は<a href="https://psycnet.apa.org/record/1965-13273-001">Horn (1965)</a>です。</p>
<h2 id="rでの実験">Rでの実験</h2>
<p>Rで平行分析を行うには<code>psych</code>パッケージの<code>fa.parallel</code>という関数を用いれば良いのですが，ここでは原理を理解するためにパッケージを使わずにやってみます。使うデータは<code>psych</code>所収の<code>bfi</code>というデータセットです。ビッグファイブの性格特性の質問紙データで，各因子5項目ずつ計25項目の質問紙のデータです。26列目以降は回答者の属性に関するデータが入っています。サンプルサイズは2800です。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"> 
<span style="color:#a6e22e">library</span>(psych)
dat <span style="color:#f92672">&lt;-</span> bfi[,<span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">25</span>]
<span style="color:#a6e22e">head</span>(dat)

      A1 A2 A3 A4 A5 C1 C2 C3 C4 C5 E1 E2 E3 E4 E5 N1 N2 N3 N4 N5 O1 O2 O3 O4 O5
<span style="color:#ae81ff">61617</span>  <span style="color:#ae81ff">2</span>  <span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">3</span>  <span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">2</span>  <span style="color:#ae81ff">3</span>  <span style="color:#ae81ff">3</span>  <span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">3</span>  <span style="color:#ae81ff">3</span>  <span style="color:#ae81ff">3</span>  <span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">3</span>  <span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">2</span>  <span style="color:#ae81ff">2</span>  <span style="color:#ae81ff">3</span>  <span style="color:#ae81ff">3</span>  <span style="color:#ae81ff">6</span>  <span style="color:#ae81ff">3</span>  <span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">3</span>
<span style="color:#ae81ff">61618</span>  <span style="color:#ae81ff">2</span>  <span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">5</span>  <span style="color:#ae81ff">2</span>  <span style="color:#ae81ff">5</span>  <span style="color:#ae81ff">5</span>  <span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">3</span>  <span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">1</span>  <span style="color:#ae81ff">1</span>  <span style="color:#ae81ff">6</span>  <span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">3</span>  <span style="color:#ae81ff">3</span>  <span style="color:#ae81ff">3</span>  <span style="color:#ae81ff">3</span>  <span style="color:#ae81ff">5</span>  <span style="color:#ae81ff">5</span>  <span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">2</span>  <span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">3</span>  <span style="color:#ae81ff">3</span>
<span style="color:#ae81ff">61620</span>  <span style="color:#ae81ff">5</span>  <span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">5</span>  <span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">5</span>  <span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">2</span>  <span style="color:#ae81ff">5</span>  <span style="color:#ae81ff">2</span>  <span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">5</span>  <span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">5</span>  <span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">2</span>  <span style="color:#ae81ff">3</span>  <span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">2</span>  <span style="color:#ae81ff">5</span>  <span style="color:#ae81ff">5</span>  <span style="color:#ae81ff">2</span>
<span style="color:#ae81ff">61621</span>  <span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">6</span>  <span style="color:#ae81ff">5</span>  <span style="color:#ae81ff">5</span>  <span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">3</span>  <span style="color:#ae81ff">5</span>  <span style="color:#ae81ff">5</span>  <span style="color:#ae81ff">5</span>  <span style="color:#ae81ff">3</span>  <span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">2</span>  <span style="color:#ae81ff">5</span>  <span style="color:#ae81ff">2</span>  <span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">1</span>  <span style="color:#ae81ff">3</span>  <span style="color:#ae81ff">3</span>  <span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">3</span>  <span style="color:#ae81ff">5</span>
<span style="color:#ae81ff">61622</span>  <span style="color:#ae81ff">2</span>  <span style="color:#ae81ff">3</span>  <span style="color:#ae81ff">3</span>  <span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">5</span>  <span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">5</span>  <span style="color:#ae81ff">3</span>  <span style="color:#ae81ff">2</span>  <span style="color:#ae81ff">2</span>  <span style="color:#ae81ff">2</span>  <span style="color:#ae81ff">5</span>  <span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">5</span>  <span style="color:#ae81ff">2</span>  <span style="color:#ae81ff">3</span>  <span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">3</span>  <span style="color:#ae81ff">3</span>  <span style="color:#ae81ff">3</span>  <span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">3</span>  <span style="color:#ae81ff">3</span>
<span style="color:#ae81ff">61623</span>  <span style="color:#ae81ff">6</span>  <span style="color:#ae81ff">6</span>  <span style="color:#ae81ff">5</span>  <span style="color:#ae81ff">6</span>  <span style="color:#ae81ff">5</span>  <span style="color:#ae81ff">6</span>  <span style="color:#ae81ff">6</span>  <span style="color:#ae81ff">6</span>  <span style="color:#ae81ff">1</span>  <span style="color:#ae81ff">3</span>  <span style="color:#ae81ff">2</span>  <span style="color:#ae81ff">1</span>  <span style="color:#ae81ff">6</span>  <span style="color:#ae81ff">5</span>  <span style="color:#ae81ff">6</span>  <span style="color:#ae81ff">3</span>  <span style="color:#ae81ff">5</span>  <span style="color:#ae81ff">2</span>  <span style="color:#ae81ff">2</span>  <span style="color:#ae81ff">3</span>  <span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">3</span>  <span style="color:#ae81ff">5</span>  <span style="color:#ae81ff">6</span>  <span style="color:#ae81ff">1</span></code></pre></div>
<p>まずは，元データからスクリープロットを描いてみます（15因子目まで）。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"> 
R_original <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">cor</span>(dat, use<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;pairwise.complete.obs&#34;</span>) 
e_original <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">eigen</span>(R_original)
<span style="color:#a6e22e">plot</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">15</span>, e_original<span style="color:#f92672">$</span>values[1<span style="color:#f92672">:</span><span style="color:#ae81ff">15</span>], type<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;b&#34;</span>)
<span style="color:#a6e22e">abline</span>(h<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)</code></pre></div>
<p><img src="/images/scree.png" alt="スクリープロット"></p>
<p>固有値が1より大きいという基準（Kaiser基準）でいくと6因子が適当のようです。</p>
<p>ここから平行分析をやってみます。まず，データセットと同じサイズのランダムデータを用意します。2800行，25列の乱数を標準正規分布から発生させて，そこから相関行列を計算します。計算された相関行列を固有値分解して固有値のベクトルを得ます。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"> 
random <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">matrix</span>(<span style="color:#a6e22e">rnorm</span>(<span style="color:#a6e22e">nrow</span>(dat)<span style="color:#f92672">*</span><span style="color:#a6e22e">ncol</span>(dat),<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>), <span style="color:#a6e22e">nrow</span>(dat), <span style="color:#a6e22e">ncol</span>(dat))
e_random <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">eigen</span>(<span style="color:#a6e22e">cor</span>(random))</code></pre></div>
<p>ランダムデータから作られた固有値を先ほどの図に重ねてみます。</p>
<p><img src="/images/scree_p1.png" alt="スクリープロット2"></p>
<p>図中の点線が新たに作ったデータセットから得た固有値です。この点線の固有値と実際のデータの固有値を比べて，実際のデータの固有値の方が大きいところまで（図中だと6因子）を因子数として採択するというのが平行分析の考え方です。</p>
<p>ところで，ここで得られたランダムデータからの固有値は，サンプリングによるランダムな変動によりたまたま大きかったり，小さかったりするということがあるかもしれません。
そこで，ランダムデータを繰り返し発生させて，その平均の固有値との比較をしようという発想が出てきます。先ほどの手続きを50回繰り返して，その平均をとってみます。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"> 
niter <span style="color:#f92672">&lt;-</span> <span style="color:#ae81ff">50</span>
result <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">matrix</span>(<span style="color:#66d9ef">NA</span>, nrow<span style="color:#f92672">=</span>niter, ncol<span style="color:#f92672">=</span><span style="color:#a6e22e">ncol</span>(dat))
<span style="color:#a6e22e">for </span>(iter in <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span>niter){
  random <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">matrix</span>(<span style="color:#a6e22e">rnorm</span>(<span style="color:#a6e22e">nrow</span>(dat)<span style="color:#f92672">*</span><span style="color:#a6e22e">ncol</span>(dat),<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>), <span style="color:#a6e22e">nrow</span>(dat), <span style="color:#a6e22e">ncol</span>(dat))
  result[iter, ] <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">eigen</span>(<span style="color:#a6e22e">cor</span>(random))<span style="color:#f92672">$</span>values
}
rand_eigval_mean <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">apply</span>(result, <span style="color:#ae81ff">2</span>, mean)</code></pre></div>
<p>最終的に得た平均の固有値とオリジナルデータを比べたものが次の図です。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">plot</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">15</span>, e_original<span style="color:#f92672">$</span>values[1<span style="color:#f92672">:</span><span style="color:#ae81ff">15</span>], type<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;b&#34;</span>)
<span style="color:#a6e22e">points</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">15</span>, rand_eigval_mean[1<span style="color:#f92672">:</span><span style="color:#ae81ff">15</span>], type<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;l&#34;</span>, lty<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>)
<span style="color:#a6e22e">abline</span>(h<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)</code></pre></div>
<p><img src="/images/scree_p2.png" alt="スクリープロット3"></p>
<h2 id="psychのfaparallel関数">psychのfa.parallel関数</h2>
<p>なお，この手続きは<code>psych</code>の<code>fa.parallel</code>関数を使えば一行でできます。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">fa.parallel</span>(dat)</code></pre></div>
<p><img src="/images/scree_p3.png" alt="スクリープロット4"></p>
<p>関数のヘルプをみると繰り返しのデフォルトは20回のようですが，<code>n.iter</code>の引数に回数を指定すれば増やすこともできるようです。</p>
<p>&lt;ここから2020/9/24追記&gt;</p>
<h2 id="対角smcによる方法">対角SMCによる方法</h2>
<p>ところで，上でおこなった平行分析は主成分分析の結果に基づくものですが，<a href="https://doi.org/10.1177/0013164469029003031">Humphreys &amp; Ilgen（1969）</a>によって，主成分ではなく因子数の選択に適した方法が提案されています。</p>
<p>そこでは，サンプルの相関係数行列そのものから固有値を計算する代わりに，対角成分に共通性の推定値を代入した相関係数行列から固有値を計算します（この相関行列はreduced correlation matirxとも呼ばれたりしますが日本語訳をなんと言うのか知りません）。そして共通性の推定値には，ある変量とその他の変量の重みつきの合成変量の間の重相関係数の平方（squared multiple correlation; SMC）を用いる方法が知られています。</p>
<p>芝（1972）『因子分析法』によれば，この重相関係数は</p>
<p>$$
R^2 _{j \cdot n-1}=1-\frac{1}{r^{(-1)} _{jj}}
$$</p>
<p>で求められるとのことです（p.166）。ここで$r^{(-1)} _{jj}$は元の相関行列の逆行列のj番目の対角成分を表しています。この式を用いることで，もとの相関係数の逆行列さえ求めまれば簡単に共通性の推定値が得られることになります。実際にRでやってみましょう。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">smc <span style="color:#f92672">&lt;-</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span> (<span style="color:#ae81ff">1</span><span style="color:#f92672">/</span><span style="color:#a6e22e">diag</span>(<span style="color:#a6e22e">solve</span>(R_original))) 
R_smc <span style="color:#f92672">&lt;-</span> R_original
<span style="color:#a6e22e">diag</span>(R_smc) <span style="color:#f92672">&lt;-</span> smc
e_smc <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">eigen</span>(R_smc)<span style="color:#f92672">$</span>values</code></pre></div>
<p>比較のために，対角SMCと対角1のものとを重ねてプロットしてみます。青い線の方が対角SMCのものです。</p>
<p><img src="/images/scree_p4.png" alt="スクリープロット5"></p>
<p>先ほどと同様に同じサイズのランダムデータをたくさん生成します。ランダムデータの相関行列からやはりSMCを計算し，それを対角成分に入れてから固有値を計算します。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">niter <span style="color:#f92672">&lt;-</span> <span style="color:#ae81ff">50</span>
result <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">matrix</span>(<span style="color:#66d9ef">NA</span>, nrow<span style="color:#f92672">=</span>niter, ncol<span style="color:#f92672">=</span><span style="color:#a6e22e">ncol</span>(dat))

<span style="color:#a6e22e">for </span>(iter in <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span>niter){
  random <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">matrix</span>(<span style="color:#a6e22e">rnorm</span>(<span style="color:#a6e22e">nrow</span>(dat)<span style="color:#f92672">*</span><span style="color:#a6e22e">ncol</span>(dat),<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>), <span style="color:#a6e22e">nrow</span>(dat), <span style="color:#a6e22e">ncol</span>(dat))
  random_cor<span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">cor</span>(random)
  smc_rand <span style="color:#f92672">&lt;-</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">-</span> (<span style="color:#ae81ff">1</span><span style="color:#f92672">/</span><span style="color:#a6e22e">diag</span>(<span style="color:#a6e22e">solve</span>(random_cor)))
  <span style="color:#a6e22e">diag</span>(random_cor) <span style="color:#f92672">&lt;-</span> smc_rand
  result[iter, ] <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">eigen</span>(random_cor)<span style="color:#f92672">$</span>values
}
rand_eigval_mean <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">apply</span>(result, <span style="color:#ae81ff">2</span>, mean)</code></pre></div>
<p>これを先ほどのプロットに重ねてみたものがこちら。対角SMCによる方法では8因子までを推奨しています。</p>
<p><img src="/images/scree_p5.png" alt="スクリープロット6"></p>
<p>ちなみに<code>psych</code>の<code>fa.parallel()</code>関数でやる場合には引数に<code>SMC=T</code>とすると同じ結果が得られます。</p>
<p>&lt;2020/9/24追記ここまで&gt;</p>

    </div>
  </article>

  
  






  <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/profile">Profile</a></li>
         
          <li><a href="https://researchmap.jp/onoshima">Works(researchmap)</a></li>
         
          <li><a href="/posts/">Blog</a></li>
        
      </ul>
    </div>

    
    <div id="toc-footer" style="display: none">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#はじめに">はじめに</a></li>
    <li><a href="#rでの実験">Rでの実験</a></li>
    <li><a href="#psychのfaparallel関数">psychのfa.parallel関数</a></li>
    <li><a href="#対角smcによる方法">対角SMCによる方法</a></li>
  </ul>
</nav>
    </div>
    

    <div id="share-footer" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fonoshima.github.io%2fposts%2fparallel%2f" aria-label="Facebook">
      <i class="fab fa-facebook fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2fonoshima.github.io%2fposts%2fparallel%2f&text=%e6%8e%a2%e7%b4%a2%e7%9a%84%e5%9b%a0%e5%ad%90%e5%88%86%e6%9e%90%e3%81%ae%e9%9a%9b%e3%81%ae%e5%b9%b3%e8%a1%8c%e5%88%86%e6%9e%90%e3%81%ab%e3%81%a4%e3%81%84%e3%81%a6" aria-label="Twitter">
      <i class="fab fa-twitter fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fonoshima.github.io%2fposts%2fparallel%2f&title=%e6%8e%a2%e7%b4%a2%e7%9a%84%e5%9b%a0%e5%ad%90%e5%88%86%e6%9e%90%e3%81%ae%e9%9a%9b%e3%81%ae%e5%b9%b3%e8%a1%8c%e5%88%86%e6%9e%90%e3%81%ab%e3%81%a4%e3%81%84%e3%81%a6" aria-label="Linkedin">
      <i class="fab fa-linkedin fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fonoshima.github.io%2fposts%2fparallel%2f&is_video=false&description=%e6%8e%a2%e7%b4%a2%e7%9a%84%e5%9b%a0%e5%ad%90%e5%88%86%e6%9e%90%e3%81%ae%e9%9a%9b%e3%81%ae%e5%b9%b3%e8%a1%8c%e5%88%86%e6%9e%90%e3%81%ab%e3%81%a4%e3%81%84%e3%81%a6" aria-label="Pinterest">
      <i class="fab fa-pinterest fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=%e6%8e%a2%e7%b4%a2%e7%9a%84%e5%9b%a0%e5%ad%90%e5%88%86%e6%9e%90%e3%81%ae%e9%9a%9b%e3%81%ae%e5%b9%b3%e8%a1%8c%e5%88%86%e6%9e%90%e3%81%ab%e3%81%a4%e3%81%84%e3%81%a6&body=Check out this article: https%3a%2f%2fonoshima.github.io%2fposts%2fparallel%2f" aria-label="Email">
      <i class="fas fa-envelope fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2fonoshima.github.io%2fposts%2fparallel%2f&title=%e6%8e%a2%e7%b4%a2%e7%9a%84%e5%9b%a0%e5%ad%90%e5%88%86%e6%9e%90%e3%81%ae%e9%9a%9b%e3%81%ae%e5%b9%b3%e8%a1%8c%e5%88%86%e6%9e%90%e3%81%ab%e3%81%a4%e3%81%84%e3%81%a6" aria-label="Pocket">
      <i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2fonoshima.github.io%2fposts%2fparallel%2f&title=%e6%8e%a2%e7%b4%a2%e7%9a%84%e5%9b%a0%e5%ad%90%e5%88%86%e6%9e%90%e3%81%ae%e9%9a%9b%e3%81%ae%e5%b9%b3%e8%a1%8c%e5%88%86%e6%9e%90%e3%81%ab%e3%81%a4%e3%81%84%e3%81%a6" aria-label="reddit">
      <i class="fab fa-reddit fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2fonoshima.github.io%2fposts%2fparallel%2f&name=%e6%8e%a2%e7%b4%a2%e7%9a%84%e5%9b%a0%e5%ad%90%e5%88%86%e6%9e%90%e3%81%ae%e9%9a%9b%e3%81%ae%e5%b9%b3%e8%a1%8c%e5%88%86%e6%9e%90%e3%81%ab%e3%81%a4%e3%81%84%e3%81%a6&description=%e3%81%af%e3%81%98%e3%82%81%e3%81%ab%20%e5%9b%a0%e5%ad%90%e5%88%86%e6%9e%90%e3%81%ab%e9%96%a2%e9%80%a3%e3%81%97%e3%81%9f%e8%aa%bf%e3%81%b9%e7%89%a9%e3%81%ae%e5%bf%85%e8%a6%81%e3%81%8c%e3%81%82%e3%81%a3%e3%81%a6%ef%bc%8c%e3%81%9d%e3%81%ae%e8%a6%9a%e6%9b%b8%e3%80%82%e4%bb%8a%e5%9b%9e%e3%81%af%e5%b9%b3%e8%a1%8c%e5%88%86%e6%9e%90%e3%81%ab%e3%81%a4%e3%81%84%e3%81%a6%e3%80%82%0a%e6%8e%a2%e7%b4%a2%e7%9a%84%e5%9b%a0%e5%ad%90%e5%88%86%e6%9e%90%e3%81%a7%e5%9b%a0%e5%ad%90%e6%95%b0%e3%82%92%e6%b1%ba%e3%82%81%e3%82%8b%e3%81%9f%e3%82%81%e3%81%ae%e8%a4%87%e6%95%b0%e3%81%ae%e5%9f%ba%e6%ba%96%e3%81%8c%e6%8f%90%e6%a1%88%e3%81%95%e3%82%8c%e3%81%a6%e3%81%84%e3%81%be%e3%81%99%e3%81%8c%ef%bc%8c%e5%b9%b3%e8%a1%8c%e5%88%86%e6%9e%90%ef%bc%88parallel%20analysis%ef%bc%89%e3%81%af%e3%81%9d%e3%81%ae%e4%b8%80%e3%81%a4%e3%81%a7%ef%bc%8c%e5%9b%a0%e5%ad%90%e5%88%86%e6%9e%90%e3%81%ae%e6%95%99%e7%a7%91%e6%9b%b8%e3%81%aa%e3%81%a9%e3%81%a7%e3%82%82%e5%8b%a7%e3%82%81%e3%82%89%e3%82%8c%e3%82%8b%e6%96%b9%e6%b3%95%e3%81%a7%e3%81%99%e3%80%82%e3%82%a2%e3%82%a4%e3%83%87%e3%82%a2%e3%81%a8%e3%81%97%e3%81%a6%e3%81%af%ef%bc%8c%e5%88%86%e6%9e%90%e3%81%97%e3%82%88%e3%81%86%e3%81%a8%e3%81%97%e3%81%a6%e3%81%84%e3%82%8b%e3%83%87%e3%83%bc%e3%82%bf%e3%82%bb%e3%83%83%e3%83%88%e3%81%a8%e5%90%8c%e3%81%98%e3%82%b5%e3%82%a4%e3%82%ba%e3%81%a7%e3%81%82%e3%82%8b%e3%83%a9%e3%83%b3%e3%83%80%e3%83%a0%e3%81%aa%e3%83%87%e3%83%bc%e3%82%bf%e3%82%bb%e3%83%83%e3%83%88%e3%81%8b%e3%82%89%e8%a8%88%e7%ae%97%e3%81%95%e3%82%8c%e3%81%9f%e5%9b%ba%e6%9c%89%e5%80%a4%e3%81%a8%e6%af%94%e3%81%b9%e3%81%a6%ef%bc%8c%e3%83%a9%e3%83%b3%e3%83%80%e3%83%a0%e3%81%aa%e3%83%87%e3%83%bc%e3%82%bf%e3%82%bb%e3%83%83%e3%83%88%e3%82%88%e3%82%8a%e3%82%82%e5%a4%a7%e3%81%8d%e3%81%84%e5%9b%ba%e6%9c%89%e5%80%a4%e3%81%be%e3%81%a7%e3%82%92%e6%8e%a1%e7%94%a8%e3%81%97%e3%82%88%e3%81%86%e3%81%a8%e3%81%84%e3%81%86%e8%80%83%e3%81%88%e3%81%ae%e3%82%88%e3%81%86%e3%81%a7%e3%81%99%e3%80%82%e3%81%93%e3%81%86%e3%81%99%e3%82%8b%e3%81%93%e3%81%a8%e3%81%a7%e3%82%b5%e3%83%b3%e3%83%97%e3%83%aa%e3%83%b3%e3%82%b0%e3%81%ae%e8%aa%a4%e5%b7%ae%e3%81%ab%e5%af%be%e5%bf%9c%e3%81%a7%e3%81%8d%e3%82%8b%e3%81%a8%e3%81%ae%e3%81%93%e3%81%a8%e3%81%a7%e3%81%99%e3%80%82%e5%88%9d%e5%87%ba%e3%81%afHorn%20%281965%29%e3%81%a7%e3%81%99%e3%80%82%0aR%e3%81%a7%e3%81%ae%e5%ae%9f%e9%a8%93%20R%e3%81%a7%e5%b9%b3%e8%a1%8c%e5%88%86%e6%9e%90%e3%82%92%e8%a1%8c%e3%81%86%e3%81%ab%e3%81%afpsych%e3%83%91%e3%83%83%e3%82%b1%e3%83%bc%e3%82%b8%e3%81%aefa.parallel%e3%81%a8%e3%81%84%e3%81%86%e9%96%a2%e6%95%b0%e3%82%92%e7%94%a8%e3%81%84%e3%82%8c%e3%81%b0%e8%89%af%e3%81%84%e3%81%ae%e3%81%a7%e3%81%99%e3%81%8c%ef%bc%8c%e3%81%93%e3%81%93%e3%81%a7%e3%81%af%e5%8e%9f%e7%90%86%e3%82%92%e7%90%86%e8%a7%a3%e3%81%99%e3%82%8b%e3%81%9f%e3%82%81%e3%81%ab%e3%83%91%e3%83%83%e3%82%b1%e3%83%bc%e3%82%b8%e3%82%92%e4%bd%bf%e3%82%8f%e3%81%9a%e3%81%ab%e3%82%84%e3%81%a3%e3%81%a6%e3%81%bf%e3%81%be%e3%81%99%e3%80%82%e4%bd%bf%e3%81%86%e3%83%87%e3%83%bc%e3%82%bf%e3%81%afpsych%e6%89%80%e5%8f%8e%e3%81%aebfi%e3%81%a8%e3%81%84%e3%81%86%e3%83%87%e3%83%bc%e3%82%bf%e3%82%bb%e3%83%83%e3%83%88%e3%81%a7%e3%81%99%e3%80%82%e3%83%93%e3%83%83%e3%82%b0%e3%83%95%e3%82%a1%e3%82%a4%e3%83%96%e3%81%ae%e6%80%a7%e6%a0%bc%e7%89%b9%e6%80%a7%e3%81%ae%e8%b3%aa%e5%95%8f%e7%b4%99%e3%83%87%e3%83%bc%e3%82%bf%e3%81%a7%ef%bc%8c%e5%90%84%e5%9b%a0%e5%ad%905%e9%a0%85%e7%9b%ae%e3%81%9a%e3%81%a4%e8%a8%8825%e9%a0%85%e7%9b%ae%e3%81%ae%e8%b3%aa%e5%95%8f%e7%b4%99%e3%81%ae%e3%83%87%e3%83%bc%e3%82%bf%e3%81%a7%e3%81%99%e3%80%8226%e5%88%97%e7%9b%ae%e4%bb%a5%e9%99%8d%e3%81%af%e5%9b%9e%e7%ad%94%e8%80%85%e3%81%ae%e5%b1%9e%e6%80%a7%e3%81%ab%e9%96%a2%e3%81%99%e3%82%8b%e3%83%87%e3%83%bc%e3%82%bf%e3%81%8c%e5%85%a5%e3%81%a3%e3%81%a6%e3%81%84%e3%81%be%e3%81%99%e3%80%82%e3%82%b5%e3%83%b3%e3%83%97%e3%83%ab%e3%82%b5%e3%82%a4%e3%82%ba%e3%81%af2800%e3%81%a7%e3%81%99%e3%80%82%0alibrary%28psych%29%20dat%20%26lt%3b-%20bfi%5b%2c1%3a25%5d%20head%28dat%29%20A1%20A2%20A3%20A4%20A5%20C1%20C2%20C3%20C4%20C5%20E1%20E2%20E3%20E4%20E5%20N1%20N2%20N3%20N4%20N5%20O1%20O2%20O3%20O4%20O5%2061617%202%204%203%204%204%202%203%203%204%204%203%203%203%204%204%203%204%202%202%203%203%206%203%204%203%2061618%202%204%205%202%205%205%204%204%203%204%201%201%206%204%203%203%203%203%205%205%204%202%204%203%203%2061620%205%204%205%204%204%204%205%204%202%205%202%204%204%204%205%204%205%204%202%203%204%202%205%205%202%2061621%204%204%206%205%205%204%204%203%205%205%205%203%204%204%204%202%205%202%204%201%203%203%204%203%205%2061622%202%203%203%204%205%204%204%205%203%202%202%202%205%204%205%202%203%204%204%203%203%203%204%203%203%2061623%206%206%205%206%205%206%206%206%201%203%202%201%206%205%206%203%205%202%202%203%204%203%205%206%201%20%e3%81%be%e3%81%9a%e3%81%af%ef%bc%8c%e5%85%83%e3%83%87%e3%83%bc%e3%82%bf%e3%81%8b%e3%82%89%e3%82%b9%e3%82%af%e3%83%aa%e3%83%bc%e3%83%97%e3%83%ad%e3%83%83%e3%83%88%e3%82%92%e6%8f%8f%e3%81%84%e3%81%a6%e3%81%bf%e3%81%be%e3%81%99%ef%bc%8815%e5%9b%a0%e5%ad%90%e7%9b%ae%e3%81%be%e3%81%a7%ef%bc%89%e3%80%82" aria-label="Tumblr">
      <i class="fab fa-tumblr fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fonoshima.github.io%2fposts%2fparallel%2f&t=%e6%8e%a2%e7%b4%a2%e7%9a%84%e5%9b%a0%e5%ad%90%e5%88%86%e6%9e%90%e3%81%ae%e9%9a%9b%e3%81%ae%e5%b9%b3%e8%a1%8c%e5%88%86%e6%9e%90%e3%81%ab%e3%81%a4%e3%81%84%e3%81%a6" aria-label="Hacker News">
      <i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>

    <div id="actions-footer">
      
        <a id="menu-toggle" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;" aria-label="Menu">
          <i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
        <a id="toc-toggle" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;" aria-label="TOC">
          <i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share-toggle" class="icon" href="#" onclick="$('#share-footer').toggle();return false;" aria-label="Share">
          <i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" aria-label="Top of Page">
          <i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>


  <footer id="footer">
  <div class="footer-left">
    Copyright  &copy; 2022  Takahiro ONOSHIMA 
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/profile">Profile</a></li>
         
        <li><a href="https://researchmap.jp/onoshima">Works(researchmap)</a></li>
         
        <li><a href="/posts/">Blog</a></li>
        
      </ul>
    </nav>
  </div>
</footer>


  </div>
</body>

<link rel="stylesheet" href=/lib/font-awesome/css/all.min.css>
<script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>

<script src=/js/code-copy.js></script>



  


<script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']]
    },
    svg: {
      fontCache: 'global'
    }
  };
</script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>

</html>
