<!DOCTYPE html>
<html class="no-js" lang="ja">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>2段階検定についての統計の教科書の記述 - Takahiro ONOSHIMA&#39;s website</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	
	
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">
	<link rel="stylesheet" href="/css/style.css">
	<link rel="stylesheet" href="/css/custom.css">
	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container">
		<div class="logo">
			<a class="logo__link" href="/" title="Takahiro ONOSHIMA&#39;s website" rel="home">
				<div class="logo__title">Takahiro ONOSHIMA&#39;s website</div>
				<div class="logo__tagline">小野島昂洋の個人サイト</div>
			</a>
		</div>
		
<nav class="menu">
	<button class="menu__btn" aria-haspopup="true" aria-expanded="false" tabindex="0">
		<span class="menu__btn-title" tabindex="-1">Menu</span>
	</button>
	<ul class="menu__list">
		<li class="menu__item">
			<a class="menu__link" href="/">
				
				<span class="menu__text">Home</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/profile/">
				
				<span class="menu__text">Profile</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/works/">
				
				<span class="menu__text">Works</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/stat/">
				
				<span class="menu__text">STAT/R</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/posts/">
				
				<span class="menu__text">Others</span>
				
			</a>
		</li>
	</ul>
</nav>


	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">2段階検定についての統計の教科書の記述</h1>
			<div class="post__meta meta">
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg>
	<time class="meta__text" datetime="2020-10-20T11:22:38">October 20, 2020</time>
	<time class="meta__text" datetime="2020-10-20T16:28:06"> (Last Modified: October 20, 2020)</time>
</div>

<div class="meta__item-categories meta__item">
	<svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2l1 2h8v11h-16v-13z"/></svg>
	<span class="meta__text"><a class="meta__link" href="/categories/stat/" rel="category">stat</a>
	</span>
</div></div>
		</header>
<div class="post__toc toc">
	<div class="toc__title">Page content</div>
	<div class="toc__menu">
		<nav id="TableOfContents">
  <ul>
    <li><a href="#はじめに">はじめに</a></li>
    <li><a href="#芝南風原1990行動科学における統計解析法">芝・南風原（1990）『行動科学における統計解析法』</a></li>
    <li><a href="#森吉田1990心理学のためのデータ解析テクニカルブック">森・吉田（1990）『心理学のためのデータ解析テクニカルブック』</a></li>
    <li><a href="#宮埜1993心理学のためのデータ解析法">宮埜（1993）『心理学のためのデータ解析法』</a></li>
    <li><a href="#吉田1998本当にわかりやすいすごく大切なことが書いてあるごく初歩の統計の本">吉田（1998）『本当にわかりやすいすごく大切なことが書いてあるごく初歩の統計の本』</a></li>
    <li><a href="#山田杉澤村井2008rによるやさしい統計学">山田・杉澤・村井（2008）『Rによるやさしい統計学』</a></li>
    <li><a href="#宮川2015基本統計学第4版">宮川（2015）『基本統計学（第4版）』</a></li>
    <li><a href="#howell-2010-statistical-methods-for-psychology7th-ed">Howell (2010) <em>Statistical Methods for Psychology(7th ed.)</em></a></li>
    <li><a href="#field-miles--field-2012-discovering-statistics-using-r">Field, Miles, &amp; Field (2012) <em>Discovering statistics using R</em></a></li>
    <li><a href="#herzog-francis--clarke-2019-understandig-statistics-and-experimental-design">Herzog, Francis, &amp; Clarke (2019) <em>Understandig Statistics and Experimental Design</em></a></li>
    <li><a href="#leppink-2019statistical-methods-for-experimental-research-in-education-and-psychology">Leppink (2019)<em>Statistical Methods for Experimental Research in Education and Psychology</em></a></li>
  </ul>
</nav>
	</div>
</div>
<div class="content post__content clearfix">
			<h2 id="はじめに">はじめに</h2>
<p>2つの群の平均値の差を検定するときにはt検定がよく使われます。このとき2つの群の分散が異なるときに普通のt検定を行うとタイプIエラーを犯す可能性が大きくなりますが，Welchのt検定を使うとそれをコントロールすることができます。</p>
<ul>
<li><a href="https://academic-oup-com.ez.wul.waseda.ac.jp/biomet/article/29/3-4/350/256577">https://academic-oup-com.ez.wul.waseda.ac.jp/biomet/article/29/3-4/350/256577</a></li>
</ul>
<p>等分散の仮定を違反したときに，どの程度悪いことが起きるのか，そしてWelchの方法を使うとどの程度それがコントロールできるかについては青木先生の次のシミュレーションが大変参考になります。</p>
<ul>
<li><a href="http://aoki2.si.gunma-u.ac.jp/lecture/BF/index.html">http://aoki2.si.gunma-u.ac.jp/lecture/BF/index.html</a></li>
</ul>
<p>統計学のテキストの中には，2つの群の等分散の判断にF検定など分散に関する検定を用いて，その結果をもとに普通のt検定を行うかWelchのt検定を用いるかを判断するべし，という記述があったりします。ここではこれを便宜的に2段階検定法と呼びますが，この2段階検定法の問題点は様々なところで指摘されています。井口先生の次のサイトがかなり詳しく書いています。</p>
<ul>
<li><a href="https://biolab.sakura.ne.jp/welch-test.html">https://biolab.sakura.ne.jp/welch-test.html</a></li>
</ul>
<p>また，奥村先生の次の簡易的なシミュレーションも参考になります。</p>
<ul>
<li><a href="https://oku.edu.mie-u.ac.jp/~okumura/blog/node/2262">https://oku.edu.mie-u.ac.jp/~okumura/blog/node/2262</a></li>
</ul>
<p>ところで，統計解析のテキストはこの問題についてどう書いているのかふと気になりましたので，以下調べてみた記録を以下に残しておきます（手元にあったもののみですが）。</p>
<h2 id="芝南風原1990行動科学における統計解析法">芝・南風原（1990）『行動科学における統計解析法』</h2>
<p>2段階検定を推奨している訳ではないですが，そういう手法をとることがあると紹介しています（pp.108-9）。</p>
<blockquote>
<p>ところで，ここで述べた検定法を適用するときは，2群の母集団分散が等しいという仮定が妥当であるかどうかを，実際に得られた標本分散を用いて確認する必要がある。その際，2群の母集団分散に関する仮説$H_0：\sigma_1 ^2 =\sigma_2 ^2$の検定を利用することがある。この仮説が棄却されない場合でも，それが等分散を証明することにはならないが，その仮定が消極的ながら指示されたとみなすのである。</p>
</blockquote>
<p>母分散が等しいという帰無仮説を棄却できなかったからといって，それをもって等分散の証明にならないと明示しているのは親切ですね。</p>
<h2 id="森吉田1990心理学のためのデータ解析テクニカルブック">森・吉田（1990）『心理学のためのデータ解析テクニカルブック』</h2>
<p>以下の記述（p.62）のように2段階検定を推奨しています。</p>
<blockquote>
<p>2つの条件の平均値の差について検定を行うためには，2条件の分散が等質であるという前提条件が満たされていなければならない。そこで，まず，この条件が満たされているかどうか調べておこう。これにはF検定を行えばよい。</p>
</blockquote>
<h2 id="宮埜1993心理学のためのデータ解析法">宮埜（1993）『心理学のためのデータ解析法』</h2>
<p>Welchの方法についての紹介はなく普通のt検定のみの解説ですが，等分散性の仮定についての以下のような補足があります。</p>
<blockquote>
<p>実データでは正規性および等分散性の家庭は必ずしも満足されない。しかし，正規性については標本の大きさが15以上ならば満足されなくても検定結果はあまり変わらない。また，等分散性についても分散比が0.4から2.5の範囲にある場合や$n_1 = n_2$である場合にはあまり結果に影響しないことが知られている。</p>
</blockquote>
<p>等分散性についてのこの性質が誰の何の研究に基づいているのかは分からないのですが，巻末にいくつか参考にした文献が挙げられており，そのいずれかにこの記述があるのだと思われます。手元にその文献はないため確認できていませんが。</p>
<h2 id="吉田1998本当にわかりやすいすごく大切なことが書いてあるごく初歩の統計の本">吉田（1998）『本当にわかりやすいすごく大切なことが書いてあるごく初歩の統計の本』</h2>
<p>「対応のない場合のt検定を適用する際の前提条件」というコラム（？）のようなものがあり（p.191）そこには以下のように書いてあります。</p>
<blockquote>
<p>②両条件の母集団の分散（ないし，標準偏差）が等しいこと。ただし，これも実際には得られたデータの分散が条件間で大きく異らなければよしとします。そして，両条件の分散に顕著な差が認められた場合には，この章の3節で解説するU検定や，ウェルチ（Welch）の検定，コクラン・コックス（Cochran-Cox）の検定などの他の検定を用います。</p>
</blockquote>
<p>コラムの中では分散の異なりの判定については述べていませんが，注には，「2つの条件の分散の差の検定については森・吉田（1990）のF検定の部分を見るように書いているので2段階検定を推奨しているようです。</p>
<h2 id="山田杉澤村井2008rによるやさしい統計学">山田・杉澤・村井（2008）『Rによるやさしい統計学』</h2>
<p>t検定に関する章の中で，等分散性の検定を行うように書いています。まとめの段落では以下のように書かれているので，2段階検定が推奨されています（p.150）。</p>
<blockquote>
<p>ここまでの内容を整理しておきましょう。まず，var.test関数を実行して分散の等質性をチェックします。その結果，等分散の仮定が満たされていたら独立な2群のt検定（<code>t.test(クラスA，クラスB，var.equal=TRUE)</code>）を，そうでなかったらWelchの検定（<code>t.test(クラスA, クラスB，var.equal=FALSE)</code>）を行うということです。</p>
</blockquote>
<h2 id="宮川2015基本統計学第4版">宮川（2015）『基本統計学（第4版）』</h2>
<p>Welchの方法についての記載はなく，p.267の注で以下のように書いています。</p>
<blockquote>
<p>$\sigma_1 ^2 \neq \sigma_2 ^2 $ のときの検定方法もあるが，それは本書では扱わない。なお， $\sigma_1 ^2 = \sigma_2 ^2 $としてよいかどうかは，後述（9.7節，275-277ページ）の検定方により調べることができる。</p>
</blockquote>
<p>pp.275-277で紹介されるのはF検定なので，2段階推定を紹介しているようです。</p>
<p>英語の統計のテキストというのはあまり持っていないのですが，いくつか手元にあったもので調べてみました。</p>
<h2 id="howell-2010-statistical-methods-for-psychology7th-ed">Howell (2010) <em>Statistical Methods for Psychology(7th ed.)</em></h2>
<p>等分散の仮定が違反された場合には，Welch-を使えと書いており，等分散のチェックにはLeveneの方法を使えと書いてあり，2段階検定を推奨しています（pp.214-215）。なお等分散の検定にF検定を使うのは，データの非正規性の影響を強く受けるので採用しないとのことです。</p>
<h2 id="field-miles--field-2012-discovering-statistics-using-r">Field, Miles, &amp; Field (2012) <em>Discovering statistics using R</em></h2>
<p>p.373で分散の等分散性についてコラムがあります。そこでは，</p>
<blockquote>
<p>[S]tatisticians used to recommend testing for it[homogeneity of variance] (using Levene&rsquo;s test) and if the assumption was violated, use an adjustment to correct for it. However, more recently statisticians have stopped using this approach, for two reasons. First, violating this assumption only matters if you have unequal group sizes; if you don&rsquo;t have unequal group sizes, the assumption is pretty much irrelevant and can be ignored. Second, the tests of homogeneity of variance tend to work very well when you have equal group sizes and large samples (when it doesn&rsquo;t matter as much if you have violated the assumption) and don&rsquo;t work as well with unequal group sizes and smaller samples - which is exactly when it matters.</p>
</blockquote>
<p>のように書いてあり，2段階検定が使われなくなったことを指摘しています。その後，Welchの方法を使えば気にしないで済むと書いてあります。</p>
<p>その後のソフトウェアの使い方の解説部分でも，関数の等分散のオプションについて以下のように言っています。</p>
<blockquote>
<p>If for some reason you want to assume equal variances (we can&rsquo;t think why you would), then include the option var.equal = TRUE.</p>
</blockquote>
<h2 id="herzog-francis--clarke-2019-understandig-statistics-and-experimental-design">Herzog, Francis, &amp; Clarke (2019) <em>Understandig Statistics and Experimental Design</em></h2>
<p>4.4節で，t検定の各種の仮定の違反が紹介されて，その中で母集団分散が異なる場合について説明されています（p.57）。そこでは分散が異なる場合にタイプIエラーがどの程度増えるのかについての簡単なシミュレーションが紹介されています。分散が異なる場合の対処法については，以下のように書いてありますが，Welchの方法で検定力が下がる場合もあると書いています。等分散性の判断についての記述はありません。</p>
<blockquote>
<p>These problems can be addressed by using a variation of the t -test called the Welch test. However, there is a cost; if the population standard deviations are actually equal, then the Welch test has smaller power than the standard t -test (it is less likely to reject the null hypothesis when there really is a difference).</p>
</blockquote>
<h2 id="leppink-2019statistical-methods-for-experimental-research-in-education-and-psychology">Leppink (2019)<em>Statistical Methods for Experimental Research in Education and Psychology</em></h2>
<p>p.28で等分散性の問題を扱っています。多くの研究者が（正規性）と等分散性の検定をしてからt検定を行うとしつつもその問題点を指摘しています。</p>
<blockquote>
<p>Many researchers test both the normally distributed population and equal SDs assumptions through statistical significance tests (e.g., Fasano &amp; Francheschini, 1987; Justel, Peña, &amp; Zamar, 1997; Levene, 1960; Shapiro &amp; Wilk, 1965; Smirnov, 1948; Stephens, 1974). However, this approach is not without problems.</p>
</blockquote>
<p>問題点は3つあるとしていて，1つ目が，等分散の検定が非有意だからといってそれが等分散の証拠にはならないこと，２つ目は検定結果はサンプルサイズに依存すること，３点目は問題点という訳ではないようですが，研究者はいつでも普通のt検定とWelchの検定の結果を両方報告できる（のだから両方報告すれば良い，と解釈すればよいのかな？）としています。</p>

		</div>
	</article>
</main>




			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2020 Takahiro ONOSHIMA.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
	</div>
<script async defer src="/js/menu.js"></script>
<script src="/js/custom.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$']]
  }
});
</script>

</body>
</html>
